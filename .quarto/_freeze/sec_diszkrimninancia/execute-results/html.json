{
  "hash": "7d3c2178a24089de34648436e3a42bf5",
  "result": {
    "markdown": "# Diszkriminancia elemzés {#sec-diszkriminancia-elemzes}\n\n\n\n\n\nA diszkriminancia analízisben azt a problémát járjuk körül, hogyan lehet az emberek egyes csoportjait valamilyen vizsgált jellemzők alapján szétválasztani, az egyes csoportokat azonosítani, valamint a csoporttagságokat az előbb említett vizsgált jellemzők alapján előrejelezni. \n\nKépzeljünk el, hogy szalagmunkásokkal végeznek alkalmasság-vizsgálatot. A szalagmunka általában sok figyelmet igényel, ugyanakkor meglehetősen monoton munka, éppen ezért jó figyelmi képességek és monotónia tűrés szükséges hozzá. A lenti `szalagmunka` adatmátrix 10 személy adatát tartalmazza.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nszalagmunka <- rio::import(file = \"adat/diszkriminancia_alkalmassag.xlsx\")\nszalagmunka$bevalt <- factor(szalagmunka$bevalt, labels = c(\"nem\", \"igen\"))\nszalagmunka\n#>    bevalt figyelem monotonia_tures\n#> 1    igen        1               2\n#> 2    igen        1               5\n#> 3     nem        2               1\n#> 4    igen        2               3\n#> 5     nem        3               2\n#> 6    igen        3               4\n#> 7     nem        4               3\n#> 8     nem        4               1\n#> 9    igen        4               6\n#> 10    nem        6               5\n```\n:::\n\n\nA fenti adatok egy részét a szalagmunkára való jelentkezéskor gyűjtötték: \n\n* `figyelem`: figyelmi képességükre és\n* `monotonia_tures`: monotónia-tűrésükre vonatkozó információk.\n\nMindkét változót 7 fokú skálán értékeltek (ahol a magasabb érték jobb képességeket jelent), valamint azt az információt is láthatjuk, hogy később beváltak-e vagy sem (`bevalt`).\n\nAzt kellene megmutatnunk, hogy a figyelem és a monotónia-tűrés pontszámai alapján valóban lehet következtetést levonni a személy beválását illetően. Ha ezt sikerül egy objektív statisztikai módszerrel is igazolnunk, akkor az ezt követően szalagmunkára jelentkezőket figyelem és monotónia tűréssel vizsgálva tesztelhetjük, és egész jól ki lehet válogatni az alkalmasabb jelölteket. \n\nHa pontdiagramon ábrázoljuk az adatokat, és színezéssel jelöljük a beválást, akkor a két csoport szemmel láthatóan szétválik egymástól, ám sem a függőleges, sem a vízszintes tengely mentén nem lehet elkülöníteni a csoportokat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nggplot(szalagmunka, aes(x = figyelem, y = monotonia_tures, colour = bevalt)) +\n    geom_point(size = 4)\n```\n\n::: {.cell-output-display}\n![](sec_diszkrimninancia_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\n**A diszkriminancia elemzés sajátossága, hogy a csoportokat a magyarázó változók együttes figyelembevételével tudja szétválasztani.** Ennek megfelelően ha önmagában tekintjük az egyik (például `figyelem`) vagy másik (`monotonia_tures`) magyarázó változókat, akkor nem tudunk szignifikáns különbséget kimutatni a `bevalt` változó két csoportjában $(p = 0,108; p=0,159)$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(figyelem ~ bevalt, data = szalagmunka)$p.value\n#> [1] 0.1082333\nt.test(monotonia_tures ~ bevalt, data = szalagmunka)$p.value\n#> [1] 0.1588974\n```\n:::\n\n\nNézzük meg, hogy többváltozós variancia-analízissel (MANOVA) szét tudjuk-e választani a csoportokat, amikor a két magyarázó változót egyszerre vesszük figyelembe. Továbbra is arra keressük a választ, hogy beválás tekintetében valóban létezik-e a munkások két csoportja.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(figyelem, monotonia_tures) ~ bevalt, data = szalagmunka)\nsummary(man_1, test = \"Wilks\")\n#>           Df  Wilks approx F num Df den Df  Pr(>F)  \n#> bevalt     1 0.2708   9.4247      2      7 0.01033 *\n#> Residuals  8                                        \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti output alapján megnyugodhatunk, a bevált és a nem bevált munkások csoportja valóban különbözik egymástól $(p=0,010)$.\n\nA diszkriminancia elemzéstől azonban ettől többet fogunk várni, például predikciót is végezhetünk a kapott modellben.\n\nHa diszkriminancia elemzést szeretnénk végrehajtani, akkor a `{MASS}` csomag `lda()` függvényét használhatjuk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1 <- MASS::lda(bevalt ~ figyelem + monotonia_tures, data = szalagmunka)\nlda_1\n#> Call:\n#> lda(bevalt ~ figyelem + monotonia_tures, data = szalagmunka)\n#> \n#> Prior probabilities of groups:\n#>  nem igen \n#>  0.5  0.5 \n#> \n#> Group means:\n#>      figyelem monotonia_tures\n#> nem       3.8             2.4\n#> igen      2.2             4.0\n#> \n#> Coefficients of linear discriminants:\n#>                        LD1\n#> figyelem        -0.9981001\n#> monotonia_tures  0.8365579\n```\n:::\n\n\nA fenti outputban látható, hogy akik nem váltak be, a monotónia-tűrés tesztben gyengébb teljesítményt nyújtottak, a figyelem tesztben pedig egy jobbat, míg akik beváltak, a monotónia-tűrés tesztben igen jó teljesítményt értek el, a figyelem tesztben pedig valamivel gyengébbet. A kanonikus diszkriminancia együtthatókat is láthatjuk, melyek alapján felírhatjuk a kanonikus diszkriminancia-függvényt a következő módon:\n\n```markdown\nZ = -0,998 * figyelem + 0,837 * monotonia_tures\n```\n\nAz eddig vizsgált 10 személyről tudjuk, hogy bevált-e vagy sem, vagyis ismertük a tényleges csoporttagságát. Ám a diszkriminancia elemzés fontos célja, hogy előre jelezzük a csoporttagságokat, vagyis a figyelem és monotónia-tűrés ismeretében megmondjuk egy személyről, hogy nagy valószínűséggel beválik-e vagy sem. \n\nTegyük fel, hogy az első személy a figyelem teszten 2, míg a monotónia-tűrés teszten 4 pontot kapott, míg a második személy pontszámai ebben a sorrendben 6 és 1.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdata <- data.frame(figyelem = c(2, 6), monotonia_tures = c(4, 1))\nnewdata\n#>   figyelem monotonia_tures\n#> 1        2               4\n#> 2        6               1\nlda_1_pred <- predict(lda_1, newdata = newdata)\nlda_1_pred\n#> $class\n#> [1] igen nem \n#> Levels: nem igen\n#> \n#> $posterior\n#>          nem         igen\n#> 1 0.00743262 9.925674e-01\n#> 2 0.99999931 6.861874e-07\n#> \n#> $x\n#>         LD1\n#> 1  1.667346\n#> 2 -4.834728\n```\n:::\n\n\n\nA fenti output `class` és `posterior` része alapján láthatjuk, hogy az első személyt nagy valószínűséggel alkalmasnak, míg a másodikat alkalmatlannak ítélhetjük a szalagmunkára.\n\nUtolsó lépésként összevetjük a tényleges és a becsült csoporttagságot, és megállapítjuk, az adatok mekkora részét tudjuk helyesen besorolni az alkotott modell alapján. Ezzel magát a modellt értékeljük. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_2_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_2_pred$class, szalagmunka$bevalt)\ntab_1\n#>       \n#>        nem igen\n#>   nem    5    0\n#>   igen   0    5\n```\n:::\n\n\n\nMivel az összes adat a főátlóban van, így megállapíthatjuk, hogy a modell alapján az összes adatot helyesen kategorizáltuk. A helyes besorolás arányát százalékosan is kiszámíthatjuk, ez az arány 100%.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 100\n```\n:::\n\n\n\n\n## Példa: Kikből lesznek a balesetezők?\n\nEbben a példában azt vizsgáljuk, mely tényezők járulnak hozzá a balesetekhez.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbaleset <- rio::import(file = \"adat/diszkriminancia_baleset.xlsx\")\nbaleset$baleset <- factor(baleset$baleset, labels = c(\"nem volt baleste\",\n    \"volt baleste\"))\nstr(baleset)\n#> 'data.frame':\t36 obs. of  5 variables:\n#>  $ baleset   : Factor w/ 2 levels \"nem volt baleste\",..: 1 1 ...\n#>  $ megosztott: num  7 6 5 6 7 3 6 7 5 6 ...\n#>  $ pontossag : num  6 6 5 6 7 3 5 7 5 6 ...\n#>  $ kockazat  : num  2 3 1 2 4 7 2 1 3 2 ...\n#>  $ eszleles  : num  7 6 5 6 7 7 7 6 3 7 ...\npsych::headTail(baleset)\n#>              baleset megosztott pontossag kockazat eszleles\n#> 1   nem volt baleste          7         6        2        7\n#> 2   nem volt baleste          6         6        3        6\n#> 3   nem volt baleste          5         5        1        5\n#> 4   nem volt baleste          6         6        2        6\n#> ...             <NA>        ...       ...      ...      ...\n#> 33      volt baleste          3         3        5        4\n#> 34      volt baleste          2         2        7        1\n#> 35      volt baleste          3         3        4        4\n#> 36      volt baleste          4         4        6        4\n```\n:::\n\n\n\nAz adatbázisban a `baleset` változó azt rögzíti, hogy volt-e már balesete a személynek vagy sem. Ez lesz tehát a csoportosító változó. A többi változó, melyek segítségével próbáljuk a csoportok közötti különbséget jellemezni, olyan dolgot mérnek, mint a megosztott figyelem (`megosztott` változó), a figyelem pontossága (`pontossag`), kockázatvállalási hajlandóság (`kockazat`) és az észlelés gyorsasága (`eszleles`).\n\nA diszkriminancia-analízisben az első lépés annak megállapítása, vajon valóban szét lehet-e választani a balesetezők és a nem balesetezők csoportját az adott változók alapján. Ehhez a Wilks-lambda tesztet használjuk a többváltozós variancia-analízis keretein belül.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(megosztott, pontossag, kockazat, eszleles) ~ baleset,\n    data = baleset)\nsummary(man_1, test = \"Wilks\")\n#>           Df   Wilks approx F num Df den Df    Pr(>F)    \n#> baleset    1 0.27605   20.324      4     31 2.645e-08 ***\n#> Residuals 34                                             \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti output tesztstatisztikájának szignifikanciaszintje azt mutatja, hogy a csoportok közötti különbségek szignifikánsak, vagyis valóban van különbség a balesetet szenvedett és a balesetmentes autóvezetők között.\n\nFuttassuk le a diszkriminancia-analízis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1 <- MASS::lda(baleset ~ megosztott + pontossag + kockazat + eszleles,\n    data = baleset)\nlda_1\n#> Call:\n#> lda(baleset ~ megosztott + pontossag + kockazat + eszleles, d...\n#> \n#> Prior probabilities of groups:\n#> nem volt baleste     volt baleste \n#>        0.4722222        0.5277778 \n#> \n#> Group means:\n#>                  megosztott pontossag kockazat eszleles\n#> nem volt baleste   5.941176  5.647059 2.588235 5.941176\n#> volt baleste       2.842105  2.684211 5.578947 3.105263\n#> \n#> Coefficients of linear discriminants:\n#>                    LD1\n#> megosztott -0.25764616\n#> pontossag  -0.07708289\n#> kockazat    0.36270659\n#> eszleles   -0.36702363\n```\n:::\n\n\n\nA fenti output alapján az előzetes valószínűsége annak, hogy valakinek még nem volt balesete 0,472, míg annak a valószínűsége, hogy már volt balesete a személynek 0,528. Ezután vizsgálhatjuk a csoportátlagokat. A balesetmentes vezetők esetében magasabb a megosztott figyelem, a figyelem pontosságának és az észlelés változójának az átlaga, míg a kockázatvállalásé alacsonyabb. Ugyanakkor a másik csoport esetében a kockázatvállalás változójának az átlaga magasabb, míg a másik három képesség változójának átlaga alacsonyabb. Vagyis a balesetmentes vezetők gyorsabban képesek észlelni és jobban meg tudják osztani a figyelmüket, figyelmük pontosabb. A balesetet szenvedett vezetők esetében ezek a képességek gyengébbek, míg jobban szeretnek kockázatot vállalni.\n\nVégül a kanonikus diszkriminancia együtthatók segítségével felírhatjuk a kanonikus diszkriminancia-függvényt a következő módon:\n\n\n```markdown\nZ = 0,3627 * kockázat - 0,367 * észlelés - 0,2567 * megosztott-0,0771 * pontosság\n```\n\nUtolsó lépésként pedig megnézhetjük, mennyire hatékony a diszkriminancia-analízis vagyis összevethetjük az eredeti csoporttagságokat a modell alapján alkotott besorolásokkal.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_1_pred$class, baleset$baleset)\ntab_1\n#>                   \n#>                    nem volt baleste volt baleste\n#>   nem volt baleste               16            2\n#>   volt baleste                    1           17\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 91.66667\n```\n:::\n\n\nA fenti sorok elkészík a predikciót, majd egy táblázatban reprezentálják az eredeti és a becsült csoportba tartozásokat. A legtöbb adat a főátlóban helyezkedik el, ami igen magas helyes besorolási arányra utal. A helyes besorolások aránya 91,7%.\n\nA példában a gépjárműbalesetek emberi okait vizsgáltuk. Az eredmények alapján a balesetmentes vezetők gyorsabban képesek észlelni és jobban meg tudják osztani a figyelmüket, figyelmük pontosabb is. Ellenben a balesetet szenvedett vezetők esetében ezek a képességek gyengébbek, míg jobban szeretnek kockázatot vállalni.\n\n## Példa: A szülés utáni depresszió vizsgálata\n\nEbben a példában a szülés utáni depresszió pszichés és szociális hátterét vizsgáljuk meg a diszkriminancia-analízis segítségével.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndepresszio <- rio::import(file = \"adat/diszkriminancia_depresszio.xlsx\")\ndepresszio$ppdepresszio <- factor(depresszio$ppdepresszio, labels = c(\"nincs depresszió\",\n    \"van depresszió\"))\nstr(depresszio)\n#> 'data.frame':\t20 obs. of  5 variables:\n#>  $ ppdepresszio: Factor w/ 2 levels \"nincs depresszió\",..: 1 ...\n#>  $ szeretet    : num  7 6 2 6 7 4 6 7 6 7 ...\n#>  $ tulvedes    : num  4 2 8 3 9 5 3 5 3 5 ...\n#>  $ kor         : num  24 20 19 22 23 25 26 18 19 22 ...\n#>  $ iskola      : num  12 17 8 16 17 17 12 17 16 17 ...\npsych::headTail(depresszio)\n#>         ppdepresszio szeretet tulvedes kor iskola\n#> 1   nincs depresszió        7        4  24     12\n#> 2   nincs depresszió        6        2  20     17\n#> 3   nincs depresszió        2        8  19      8\n#> 4   nincs depresszió        6        3  22     16\n#> ...             <NA>      ...      ... ...    ...\n#> 17    van depresszió        4        7  30      6\n#> 18    van depresszió        4        6  24      8\n#> 19    van depresszió        3        7  21      9\n#> 20    van depresszió        2        8  18     10\n```\n:::\n\n\nAz adatbázisban a `ppdepresszio` változó mutatja a depresszió jelenlétét, vagy hiányát. A magyarázó változók között a következő változók szerepelnek: a szeretet skála (`szeretet` változó), amely azt méri, hogy a személyek mennyire érzik, hogy a szüleik szeretik őket; `tulvedes`-sel jelölt túlvédés iránti tendencia azt mutatja, hogy mennyire hajlamosak arra a személyek, hogy túlságosan is burokban tartsák, túlvédjék gyerekeiket, illetve szeretteiket; ezeken kívül két szociológiai adat is a rendelkezésünkre áll, nevezetesen az életkor (`kor` változó) és az elvégzett iskolai osztályok száma (`iskola`).\n\nA diszkriminancia-analízisben az első lépésében megvizsgáljuk, vajon valóban szét lehet-e választani a depressziósok és a nem depressziósok csoportját az adott változók alapján. Ehhez a Wilks-lambda tesztet használjuk a többváltozós variancia-analízis keretein belül.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(szeretet, tulvedes, kor, iskola) ~ ppdepresszio,\n    data = depresszio)\nsummary(man_1, test = \"Wilks\")\n#>              Df   Wilks approx F num Df den Df    Pr(>F)    \n#> ppdepresszio  1 0.29985   8.7561      4     15 0.0007461 ***\n#> Residuals    18                                             \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti output tesztstatisztikájának szignifikanciaszintje azt mutatja, hogy a csoportok közötti különbségek szignifikánsak, vagyis valóban van különbség a depressziós és a nem depressziós nők között az adott változókat vizsgálva.    \n\nVégezzük el a diszkriminancia elemzést!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda_1 <- lda(ppdepresszio ~ szeretet + tulvedes + kor + iskola, data = depresszio)\nlda_1\n#> Call:\n#> lda(ppdepresszio ~ szeretet + tulvedes + kor + iskola, data =...\n#> \n#> Prior probabilities of groups:\n#> nincs depresszió   van depresszió \n#>              0.5              0.5 \n#> \n#> Group means:\n#>                  szeretet tulvedes  kor iskola\n#> nincs depresszió      5.8      4.7 21.8   14.9\n#> van depresszió        3.3      7.5 24.0    8.3\n#> \n#> Coefficients of linear discriminants:\n#>                  LD1\n#> szeretet -0.21900671\n#> tulvedes  0.18422053\n#> kor       0.03467147\n#> iskola   -0.26661705\n```\n:::\n\n\nAz fenti output alapján az előzetes valószínűségek egyenlőek. A csoportátlagok közötti különbségek azt mutatják, hogy a nem depressziósok átlaga szeretet tekintetében magasabb (5,8), mint a depressziósoké (3,3), az iskolai végzettségük is magasabb (14,9), mint a depressziósoké (8,3). Ellenben a túlvédésnél a depressziósok értek el magasabb átlagot, ők az idősebbek is (24). Vagyis azok, akik postpartum depresszióban szenvednek, úgy érzik, a szüleik kevésbé szeretik őket, túlvédőbbek a gyerekeikkel szemben, idősebbek, és az iskolai végzettségük is alacsonyabb. A kanonikus diszkriminancia egyenlet alakja:\n\n\n```markdown\nZ =0,1842 * túlvédés + 0,0347 * kor - 0,2666 * iskola - 0,219 * szeretet\n```\n\n\nUtolsó momentumként az analízis értékelésére van még szükség.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_1_pred$class, depresszio$ppdepresszio)\ntab_1\n#>                   \n#>                    nincs depresszió van depresszió\n#>   nincs depresszió                9              0\n#>   van depresszió                  1             10\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 95\n```\n:::\n\n\n\nLáthatjuk, hogy a valódi és a modell alapján becsült csoporttagságok mátrixában a legtöbb adat a főátlóban helyezkedik el. Ez arra utal, hogy a becsült csoporttagságok nagyjából lefedik az eredetit,  az arány 95%.\n\nVagyis azok, akik postpartum depresszióban szenvednek, úgy érzik, a szüleik kevésbé szeretik őket, túlvédőbbek a gyerekeikkel szemben, idősebbek, és az iskolai végzettségük is alacsonyabb.\n\n## Példa: Pszichoszomatikus megbetegedésekre hajlamosító tényezők\n\nEbben a példában a pszichoszomatikus megbetegedéseket vizsgáljuk a diszkriminancia-analízis segítségével.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npszichoszomatikus <- rio::import(file = \"adat/diszkriminancia_pszichoszomatika.xlsx\")\npszichoszomatikus$pszichoszomatika <- factor(pszichoszomatikus$pszichoszomatika,\n    labels = c(\"pszichoszomatikus megbetegedése van\", \"egészséges\"))\nstr(pszichoszomatikus)\n#> 'data.frame':\t36 obs. of  4 variables:\n#>  $ pszichoszomatika: Factor w/ 2 levels \"pszichoszomatikus me...\n#>  $ stressz         : num  5 6 5 6 7 3 6 7 5 6 ...\n#>  $ szorongas       : num  6 6 5 6 7 3 3 7 5 6 ...\n#>  $ coping          : num  2 3 1 2 4 7 2 1 3 2 ...\npsych::headTail(pszichoszomatikus)\n#>                        pszichoszomatika stressz szorongas coping\n#> 1   pszichoszomatikus megbetegedése van       5         6      2\n#> 2   pszichoszomatikus megbetegedése van       6         6      3\n#> 3   pszichoszomatikus megbetegedése van       5         5      1\n#> 4   pszichoszomatikus megbetegedése van       6         6      2\n#> ...                                <NA>     ...       ...    ...\n#> 33                           egészséges       3         3      5\n#> 34                           egészséges       2         2      7\n#> 35                           egészséges       3         3      4\n#> 36                           egészséges       4         4      6\n```\n:::\n\n\nAz adatbázisban most a `pszichoszomatika` változó jelzi, hogy valamilyen pszichoszomatikus megbetegedése van vagy nincs a személynek. A változók közt szerepel a személyt ért stressz mértéke (`stressz`), a szorongási szintje (`szorongás`) és a megküzdési stratégiáinak hatékonysága (`coping`).\n\n\nA diszkriminancia-analízisben az első lépésében megvizsgáljuk, vajon valóban szét lehet-e választani a pszichoszomatikusok és a nem pszichoszomatikusok csoportját az adott változók alapján. Ehhez a Wilks-lambda tesztet használjuk a többváltozós variancia-analízis keretein belül.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(stressz, szorongas, coping) ~ pszichoszomatika, data = pszichoszomatikus)\nsummary(man_1, test = \"Wilks\")\n#>                  Df   Wilks approx F num Df den Df   Pr(>F)    \n#> pszichoszomatika  1 0.37974   17.423      3     32 6.92e-07 ***\n#> Residuals        34                                            \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti output tesztstatisztikájának szignifikanciaszintje azt mutatja, hogy a csoportok közötti különbségek szignifikánsak, vagyis valóban van különbség a két csoport között az adott változókat vizsgálva.\n\nVégezzük el a diszkriminancia elemzést.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda_1 <- lda(pszichoszomatika ~ stressz + coping + szorongas, data = pszichoszomatikus)\nlda_1\n#> Call:\n#> lda(pszichoszomatika ~ stressz + coping + szorongas, data = p...\n#> \n#> Prior probabilities of groups:\n#> pszichoszomatikus megbetegedése van \n#>                           0.4722222 \n#>                          egészséges \n#>                           0.5277778 \n#> \n#> Group means:\n#>                                      stressz   coping szorongas\n#> pszichoszomatikus megbetegedése van 5.764706 2.588235  5.529412\n#> egészséges                          2.842105 5.578947  2.684211\n#> \n#> Coefficients of linear discriminants:\n#>                   LD1\n#> stressz   -0.31309547\n#> coping     0.46637406\n#> szorongas -0.06258674\n```\n:::\n\n\n\nA fenti outputból láthatjuk, hogy a csoporttagságok előzetes valószínűsége a pszichoszomatikusok esetében kicsit kisebb (0,472). A két csoport összevetésénél azt láthatjuk, hogy a stressz és a szorongás változó átlaga a pszichoszomatikusok esetében, míg a coping változó átlaga az egészségesen esetében magasabb. Vagyis az egészséges személyeket kevesebb stressz éri, és azzal hatékonyabban is tudnak megküzdeni, mint a pszichoszomatikusok, illetve kevesebbet is szoronganak.\n\nA kanonikus diszkriminancia egyenlet pedig a következő módon alakul:\n\n```markdown\nZ = 0.4664 * coping - 0,3131 * stressz - 0,0626 * szorongas\n```\n\nUtolsó lépésként az analízis értékelésére van még szükség. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_1_pred$class, pszichoszomatikus$pszichoszomatika)\ntab_1\n#>                                      \n#>                                       pszichoszomatikus megbe...\n#>   pszichoszomatikus megbetegedése van                        ...\n#>   egészséges                                                 ...\n#>                                      \n#>                                       egészséges\n#>   pszichoszomatikus megbetegedése van          2\n#>   egészséges                                  17\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 91.66667\n```\n:::\n\n\n\nAz eredményen láthatjuk, hogy a valódi és a modell alapján becsült csoporttagságok mátrixában a legtöbb adat a főátlóban helyezkedik el. Ez arra utal, hogy a becsült csoporttagságok nagyjából lefedik az eredetit. Ez az arány 91,7%.\n\n\nEbben a példában a pszichoszomatikus megbetegedések lelki okait vizsgáltuk. Az diszkriminancia-analízis eredménye szerint az egészséges személyeket kevesebb stressz éri, és azzal hatékonyabban is tudnak megküzdeni, mint a pszichoszomatikusok, valamint kevesebbet is szoronganak.\n\n\n## Példa: Kik vásárolnak gyakran bio termékeket?\n\nUtolsó példánk a marketingkutatás területére kalauzol minket. Azt próbáljuk megvizsgálni, hogy főként kik vásárolnak bio termékeket. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nbio <- rio::import(file = \"adat/diszkriminancia_bio.xlsx\")\nbio$vasarlas <- factor(bio$vasarlas, labels = c(\"soha nem vesz\", \"időnként vesz\",\n    \"gyakran vesz\"))\ntable(bio$vasarlas)\n#> \n#> soha nem vesz időnként vesz  gyakran vesz \n#>            10            10            10\nstr(bio)\n#> 'data.frame':\t30 obs. of  5 variables:\n#>  $ vasarlas: Factor w/ 3 levels \"soha nem vesz\",..: 1 1 1 1 1...\n#>  $ ertek   : num  2 4 2 3 1 1 2 3 4 6 ...\n#>  $ attitud : num  2 4 2 3 1 3 5 3 1 2 ...\n#>  $ fizetes : num  55 67 89 78 99 112 132 78 95 64 ...\n#>  $ kor     : num  32 56 59 48 44 39 37 40 44 43 ...\npsych::headTail(bio)\n#>          vasarlas ertek attitud fizetes kor\n#> 1   soha nem vesz     2       2      55  32\n#> 2   soha nem vesz     4       4      67  56\n#> 3   soha nem vesz     2       2      89  59\n#> 4   soha nem vesz     3       3      78  48\n#> ...          <NA>   ...     ...     ... ...\n#> 27   gyakran vesz     6       6      62  19\n#> 28   gyakran vesz     9       9      69  27\n#> 29   gyakran vesz     9       9      78  28\n#> 30   gyakran vesz     8       8      73  30\n```\n:::\n\n\nAz adatbázisban a `vasarlas` változó mutatja a biotermékek vásárlásának gyakoriságát, amely három értéket vehet fel: a személy szinte soha nem vesz ilyen termékeket, időnként vesz, illetve gyakran vesz. A vásárlás gyakoriságát a következő változókkal próbáljuk előre jelezni: milyen értékeket tulajdonít ezeknek a termékeknek (`ertek` változó, minél nagyobb pontszámot kap a skálán, annál jobban értékeli a személy a bio termékeket); az `attitud` skála a termékek iránti attitűdöt méri, a magasabb értékek itt is kedvezőbb atttitűdöt jeleznek; ezen túl szerepel még a személy életkora (`kor` változó) és a fizetése is (`fizetes`).\n\nA diszkriminancia-analízisben az első lépésében megvizsgáljuk, vajon valóban szét lehet-e választani a bio termékeket vásárlók három csoportját az adott változók alapján. Ehhez a Wilks-lambda tesztet használjuk a többváltozós variancia-analízis keretein belül.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(ertek, attitud, fizetes, kor) ~ vasarlas, data = bio)\nsummary(man_1, test = \"Wilks\")\n#>           Df   Wilks approx F num Df den Df    Pr(>F)    \n#> vasarlas   2 0.12109   11.242      8     48 8.599e-09 ***\n#> Residuals 27                                             \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.aov(man_1)\n#>  Response ertek :\n#>             Df Sum Sq Mean Sq F value    Pr(>F)    \n#> vasarlas     2 146.07  73.033  27.656 2.915e-07 ***\n#> Residuals   27  71.30   2.641                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#>  Response attitud :\n#>             Df Sum Sq Mean Sq F value    Pr(>F)    \n#> vasarlas     2 211.67 105.833  57.495 1.853e-10 ***\n#> Residuals   27  49.70   1.841                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#>  Response fizetes :\n#>             Df  Sum Sq Mean Sq F value  Pr(>F)  \n#> vasarlas     2  6427.5  3213.7  3.1857 0.05726 .\n#> Residuals   27 27237.5  1008.8                  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#>  Response kor :\n#>             Df Sum Sq Mean Sq F value   Pr(>F)   \n#> vasarlas     2 1449.3  724.63  7.3001 0.002922 **\n#> Residuals   27 2680.1   99.26                    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti elemzés tesztstatisztikájának szignifikanciaszintje azt mutatja, hogy a csoportok közötti különbségek szignifikánsak, vagyis valóban van különbség a három csoport között az adott változókat vizsgálva.\n\nVégezzük el a diszkriminancia elemzést.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda_1 <- lda(vasarlas ~ ertek + attitud + fizetes + kor, data = bio)\nlda_1\n#> Call:\n#> lda(vasarlas ~ ertek + attitud + fizetes + kor, data = bio)\n#> \n#> Prior probabilities of groups:\n#> soha nem vesz időnként vesz  gyakran vesz \n#>     0.3333333     0.3333333     0.3333333 \n#> \n#> Group means:\n#>               ertek attitud fizetes  kor\n#> soha nem vesz   2.8     2.6    86.9 44.2\n#> időnként vesz   5.3     5.6   106.5 34.9\n#> gyakran vesz    8.2     9.1    70.7 27.2\n#> \n#> Coefficients of linear discriminants:\n#>                  LD1          LD2\n#> ertek    0.278041839 -0.175361797\n#> attitud  0.578431017  0.066376341\n#> fizetes -0.003687657 -0.032311789\n#> kor     -0.019282287  0.003972177\n#> \n#> Proportion of trace:\n#>    LD1    LD2 \n#> 0.9687 0.0313\n# klaR::greedy.wilks(vasarlas~ertek+attitud+fizetes+kor,data=bio,\n# niveau = 0.15)\n```\n:::\n\n\n\nA fenti output alapján az elemzés elején a három vásárlási gyakoriság valószínűsége egyenlő (0,333).  Ha a csoportátlagokat vizsgáljuk akkor láthatjuk, hogy mind az értékek, mind az attitűd változójának tekintetében a soha sem vásárolók átlaga a legalacsonyabb (3 mindkét változó esetében), az időnként bio termékeket vásárlók csoport átlaga középen helyezkedik el mind a két változó esetében (5 és 6), és a gyakran vásárlók átlaga a legmagasabb (8 és 9). Életkor tekintetében egy kissé másképpen alakulnak a csoportok. A legidősebbek szinte sohasem vásárolnak bio termékeket, a legfiatalabbak pedig igen gyakran vásárolnak. Fizetés tekintetében nem figyelhető meg jól magyarázható összefüggés: a legalacsonyabb fizetésűek gyakran, míg a közepes fizetésűek szinte soha sem vásárolnak bio termékeket.\n\nA két kanonikus diszkriminancia-egyenlet a következőképpen alakul:\n\n\n```markdown\nZ1 = 0,278 * ertek + 0,578 * attitud - 0,019 * kor - 0,004 *fizetes\nZ2 = -0,175 * ertek + 0,066 * attitud + 0,004 * kor - 0,032 *fizetes\n```\nUtolsó lépésként az analízis értékelésére van még szükség. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_1_pred$class, bio$vasarlas)\ntab_1\n#>                \n#>                 soha nem vesz időnként vesz gyakran vesz\n#>   soha nem vesz             9             1            0\n#>   időnként vesz             1             7            1\n#>   gyakran vesz              0             2            9\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 83.33333\n```\n:::\n\n\n\nA fenti eredményben láthatjuk, hogy a valódi és a modell alapján becsült csoporttagságok mátrixában a legtöbb adat a főátlóban helyezkedik el. Ez arra utal, hogy a becsült csoporttagságok nagyjából lefedik az eredetit. Ez az arány 83%.\n\nAz utolsó probléma körében a bio termékek vásárlásának gyakoriságát vizsgáltuk. A kapott eredményeink alapján azok, akik gyakran vásárolnak ilyen termékeket, pozitívabbak értékelik és pozitívabb attitűdökkel rendelkeznek a bio termékek irányában, fiatalabbak, fizetésük viszont alacsonyabb.\n\n## Példa: Vezetési programok\n\nEgy vállalat menedzsmentje szeretné megvizsgálni különböző vezetési programok hatását, ezért három különböző vezetési programot vezetett be három különböző stratégiai üzleti egységben (SÜE). Az első SÜE-ben bevezetett program az egyenlőséget és az individualizmust hangsúlyozta. A második SÜE-ben az egyenlőséget és a csoportmunkát helyzeték középpontba. A harmadik SÜE-ben a bevezetett program egy nagyon hierarchikus vezetési elvet alkalmazott. Később mindhárom SÜE dolgozóinak körében felmérést végeztek, és a kérdések között szerepelt a szervezettel való elkötelezettség mértéke (`szelkot`), a szervezettel való elégedettség nagysága (`elegedett`), illetve a rendszer egalitárius vagy tekintélyelvű (autokrata) jellege (`rendszer`).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvezetes <- rio::import(file = \"adat/diszkriminancia_vezetesi_program.xlsx\")\nvezetes$SUE <- factor(vezetes$SUE)\nstr(vezetes)\n#> 'data.frame':\t30 obs. of  4 variables:\n#>  $ SUE      : Factor w/ 3 levels \"1\",\"2\",\"3\": 1 1 1 1 1 1 1 1...\n#>  $ szelkot  : num  4 4 5 5 3 3 3 5 3 5 ...\n#>  $ elegedett: num  1 3 4 1 2 2 4 2 1 1 ...\n#>  $ rendszer : num  2 1 2 4 4 3 2 3 4 2 ...\npsych::headTail(vezetes)\n#>      SUE szelkot elegedett rendszer\n#> 1      1       4         1        2\n#> 2      1       4         3        1\n#> 3      1       5         4        2\n#> 4      1       5         1        4\n#> ... <NA>     ...       ...      ...\n#> 27     3       1         1        5\n#> 28     3       5         1        4\n#> 29     3       5         1        5\n#> 30     3       5         3        4\n```\n:::\n\n\nVégezzük el a többváltozós variancia elemzést.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(cbind(szelkot, elegedett, rendszer) ~ SUE, data = vezetes)\nsummary(man_1, test = \"Wilks\")\n#>           Df  Wilks approx F num Df den Df    Pr(>F)    \n#> SUE        2 0.1894   10.815      6     50 1.102e-07 ***\n#> Residuals 27                                            \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary.aov(man_1, test = \"Wilks\")\n#>  Response szelkot :\n#>             Df Sum Sq Mean Sq F value Pr(>F)\n#> SUE          2  2.867  1.4333  1.1057 0.3455\n#> Residuals   27 35.000  1.2963               \n#> \n#>  Response elegedett :\n#>             Df Sum Sq Mean Sq F value   Pr(>F)   \n#> SUE          2 17.267  8.6333  8.4152 0.001444 **\n#> Residuals   27 27.700  1.0259                    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#>  Response rendszer :\n#>             Df Sum Sq Mean Sq F value    Pr(>F)    \n#> SUE          2 52.267 26.1333      48 1.287e-09 ***\n#> Residuals   27 14.700  0.5444                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nlm_1 <- lm(szelkot ~ SUE, data = vezetes)\ncar::Anova(lm_1, test.statistic = c(\"Wilks\"))\n#> Anova Table (Type II tests)\n#> \n#> Response: szelkot\n#>           Sum Sq Df F value Pr(>F)\n#> SUE        2.867  2  1.1057 0.3455\n#> Residuals 35.000 27\n1 - summary(lm_1)$r.squared  # Wilks lambda\n#> [1] 0.9242958\n\nlm_1 <- lm(elegedett ~ SUE, data = vezetes)\ncar::Anova(lm_1, test.statistic = c(\"Wilks\"))\n#> Anova Table (Type II tests)\n#> \n#> Response: elegedett\n#>           Sum Sq Df F value   Pr(>F)   \n#> SUE       17.267  2  8.4152 0.001444 **\n#> Residuals 27.700 27                    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n1 - summary(lm_1)$r.squared  # Wilks lambda\n#> [1] 0.6160119\n\nlm_1 <- lm(rendszer ~ SUE, data = vezetes)\ncar::Anova(lm_1, test.statistic = c(\"Wilks\"))\n#> Anova Table (Type II tests)\n#> \n#> Response: rendszer\n#>           Sum Sq Df F value    Pr(>F)    \n#> SUE       52.267  2      48 1.287e-09 ***\n#> Residuals 14.700 27                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n1 - summary(lm_1)$r.squared  # Wilks lambda\n#> [1] 0.2195122\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbiotools::boxM(data = vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")], grouping = vezetes$SUE)\n#> \n#> \tBox's M-test for Homogeneity of Covariance Matrices\n#> \n#> data:  vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")]\n#> Chi-Sq (approx.) = 19.607, df = 12, p-value = 0.0749\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda_1 <- lda(SUE ~ szelkot + elegedett + rendszer, data = vezetes)\nlda_1\n#> Call:\n#> lda(SUE ~ szelkot + elegedett + rendszer, data = vezetes)\n#> \n#> Prior probabilities of groups:\n#>         1         2         3 \n#> 0.3333333 0.3333333 0.3333333 \n#> \n#> Group means:\n#>   szelkot elegedett rendszer\n#> 1     4.0       2.1      2.7\n#> 2     4.7       3.4      1.5\n#> 3     4.1       1.6      4.7\n#> \n#> Coefficients of linear discriminants:\n#>                   LD1       LD2\n#> szelkot   -0.07056752 0.4959142\n#> elegedett  0.10193972 0.8596451\n#> rendszer  -1.32360357 0.5392379\n#> \n#> Proportion of trace:\n#>    LD1    LD2 \n#> 0.9616 0.0384\n# klaR::greedy.wilks(vasarlas~ertek+attitud+fizetes+kor,data=bio,\n# niveau = 0.15)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\ntab_1 <- table(lda_1_pred$class, vezetes$SUE)\ntab_1\n#>    \n#>      1  2  3\n#>   1  4  1  0\n#>   2  3  9  0\n#>   3  3  0 10\n100 * sum(diag(tab_1))/sum(tab_1)\n#> [1] 76.66667\n```\n:::\n\n\n\n## Megjegyzések\n\nDiszkriminancia analízis esetén az adatokat nem szükséges standardizálni, ennek oka, hogy az analízis eredményét nem befolyásolja jelentős mértékben az egyes változók mértékegysége. \n\nA függő változónk tehát kategorikus, a függetlenek pedig numerikusak. Arra vagyunk kíváncsiak, hogy a függő változó által meghatározott csoportok mely független változókban különböznek egymástól, melyek különböztetik meg egy egymástól a függő változó kategóriáit.\n\nHa a kategorikus függő változónk csupán kétértékű, akkor kétváltozós diszkriminancia elemzésről beszélünk, több szint esetén többváltozós diszkiriminancia elemzésről.\n\n\n## Az alkalmazási feltételek\n\nA fűggő változó kategorikus két vagy több szinttel. A független változók intervallum vagy arány skálájú változók, de használhatunk dichotóm változókat és a legalább 5 fokú likert skálán mért értékeket is. A függő változó csoportjaiban nagyjából azanosnak kell lennie a csoportnagyságnak, minden csoportnak legalább két adatsort tartalmaznia kell. A mintanagyságra is figyelnünk kell, a független változók számának kisebb kell lenni, mint a legkisebb csoport esetszáma, a teljes mintanagyság legalább 10-szer nagyobb a független változók számánál. A diszkriminancia elemzés feltételezi a független változók közötti lineáris kapcsolatot. \n\nAz egyváltozós normalitás vizsgálatára a kiugró értékek vizsgálata javasolt, illetve megfelelő mérési skála (például nem dichotóm változó esetén) a Shapiro--Wilk-próbát is használhatjuk. \nA többváltozós normalitás vizsgálatához  \n\n\n\n\nA csoportok szétválasztásának egyik megközelítése a Mahalanobis-féle távolságot használja. Az eljárás lényege, hogy az $m$ csoportot tartalmazó minta átlagvektorával becsüljük a csoportok valódi átlagvektorát. Az egyes személyek csoportközéptől való átlagát számoljuk ki a Mahalanobis-féle távolsággal, és minden személyt abba a csoportba sorolunk be ez alapján, amelyhez közelebb esik. Ez lehet az a csoport, amelybe a személy valóban beletartozik, de lehet másik is. A helyes besorolások aránya világosan megmutatja, hogy mennyire jól lehet a csoportokat szétválasztani a használt változók alapján.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# remotes::install_github('hyunsooseol/snowCluster')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(snowCluster)\nvallalat <- rio::import(file = \"adat/diszkriminancia_vezetesi_program.sav\")\nsnowCluster::disc(\n    data = vallalat,\n    dep = SUE,\n    covs = vars(szelköt, elégedett, rendszer),\n    gm = TRUE,\n    coef = TRUE,\n    prop = TRUE,\n    tes = TRUE,\n    plot = TRUE,\n    plot1 = TRUE,\n    plot2 = TRUE)\n\n\nstr(vallalat)\nvallalat$SUE <- factor(vallalat$SUE)\n\nlda_1 <- MASS::lda(SUE ~ szelköt + elégedett + rendszer, data = vallalat)\nlda_1\n\nman_1 <- stats::manova(cbind(szelköt, elégedett, rendszer)~SUE, data=vallalat)\nman_1\nsummary(man_1, test=\"Wilks\")\nsummary.aov(man_1)\n\nF <- 1.1057 # F próbastatisztika érték\np <- 1 # függő változók száma\nn <- 30 # mintaelemszám\nk <- 3  # a független változó csoportjainak a száma\n  \nWilks_1 <-  1 / (1 + (F * p) / (n - k - 1 - p))\nWilks_1\n\n 1 - (F / (F + 27))\n\nahol F az F-érték, df1 pedig az első szab\nanova(lm(szelköt~SUE, data=vallalat), test=\"Wilks\")\n\n\nman_1 <- manova(cbind(szelköt, elégedett, rendszer)~SUE, data=vallalat)\nsummary(man_1, test=\"Wilks\")\nsummary(man_1)\n\n\ninstall.packages(\"klaR\")\ngw_1 <- klaR::greedy.wilks(SUE ~ szelköt + elégedett + rendszer, data = vallalat, output=T)\nunclass(gw_1)\nplot(gw_1)\n\njmv::mancova(\n    data = vallalat,\n    deps = vars(szelköt, elégedett, rendszer),\n    factors = SUE,\n    multivar = \"wilks\",\n    boxM = TRUE,\n    shapiro = TRUE)\n\n??'Wilk'\nrrcov::Wilks.test(SUE ~ szelköt + elégedett + rendszer, data = vallalat)\nrrcov::Wilks.test(x = vallalat[2:4], grouping=vallalat$SUE)\n\nlibrary(klaR)\ndata(iris)\nlibrary(MASS)\niris.d <- iris[,1:4]  # the data    \niris.c <- iris[,5]    # the classes \nsc_obj <- stepclass(iris.d, iris.c, \"lda\", start.vars = \"Sepal.Width\")\nsc_obj\nplot(sc_obj)\n\n## or using formulas:\nsc_obj <- stepclass(Species ~ ., data = iris, method = \"qda\", \n    start.vars = \"Sepal.Width\", criterion = \"AS\")  # same as above \nsc_obj\n\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- rio::import(file = \"adat/diszkriminancia_alkalmassag.xlsx\")\ndata <- rio::import(file = \"adat/diszkriminancia_baleset.xlsx\")\nsnowCluster::disc(data = data, dep = baleset, covs = vars(megosztott, pontossag,\n    kockazat, eszleles), gm = TRUE, coef = TRUE, prop = TRUE, tra = TRUE,\n    plot = TRUE, plot1 = TRUE, plot2 = TRUE)\n\n\niris\n\n\n\n\n\nsnowCluster::disc(data = iris, dep = Species, covs = vars(Sepal.Length,\n    Sepal.Width, Petal.Length, Petal.Width), gm = TRUE, coef = TRUE, prop = TRUE,\n    tra = TRUE, plot = TRUE, plot1 = TRUE, plot2 = TRUE)\n```\n:::\n",
    "supporting": [
      "sec_diszkrimninancia_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}