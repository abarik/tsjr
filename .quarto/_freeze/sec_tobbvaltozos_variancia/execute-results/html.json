{
  "hash": "78ebbc96139b306f9903026b39d086a5",
  "result": {
    "markdown": "# Többváltozós varianciaelemzés {#sec-tobbvaltozos-varianciaelemzes}\n\n\n\n\n\n## Elméleti háttér\n\nA MANOVA a többváltozós varianciaelemzés angol megfelelőjéből képzett betűszó (Multivariate ANOVA vagy Multivariate Analysis of Variance). A szokásos ANOVA kiterjesztésének tekinthető, ahol nem egy, hanem kettő vagy több függő változóval dolgozhatunk, de a cél ugyanaz: a független változó több csoportja közötti különbségek elemzése.\n\nFelmerülhet bennünk, hogy ha több függő változónk van, akkor mindegyikre végezzünk el külön egy-egy hagyományos ANOVA-t, azonban ez az elsőfajú hiba emelkedéséhez vezet. A MANOVA olyan megoldást kínál, amivel több függő változó kombinált információi alapján képes kimutatni a csoportkülönbségeket.\n\nMivel a MANOVA egynél több függő változót használ, a null- és az ellenhipotézisek kissé megváltoznak:\n\n* $H_0$: A csoportok várható érték vektorai minden csoportban azonosak.\n* $H_1$: A csoportok várható érték vektorainak legalább egyike eltér egy másiktól.\n\n## Példa: Vezetési programok\n\nEgy vállalat menedzsmentje szeretné megvizsgálni különböző vezetési programok hatását, ezért három különböző vezetési programot vezetett be három különböző stratégiai üzleti egységben (SÜE). Az első SÜE-ben bevezetett program az egyenlőséget és az individualizmust hangsúlyozta. A második SÜE-ben az egyenlőséget és a csoportmunkát helyzeték középpontba. A harmadik SÜE-ben a bevezetett program egy nagyon hierarchikus vezetési elvet alkalmazott. Később mindhárom SÜE dolgozóinak körében felmérést végeztek, és a kérdések között szerepelt a szervezettel való elkötelezettség mértéke (`szelkot`), a szervezettel való elégedettség nagysága (`elegedett`), illetve a rendszer egalitárius vagy tekintélyelvű (autokrata) jellege (`rendszer`). Vizsgáljuk meg, hogy a SÜE három csoportja azonosnak tekinthető-e a vizsgált 3 kérdésre (`szelkot`, `elegedett` és `rendszer`) adott válaszok tekintetében. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nvezetes <- rio::import(file = \"adat/manova_vezetesi_program.xlsx\")\nvezetes$SUE <- factor(vezetes$SUE)\nstr(vezetes)\n#> 'data.frame':\t30 obs. of  4 variables:\n#>  $ SUE      : Factor w/ 3 levels \"1\",\"2\",\"3\": 1 1 1 1 1 1 1 1...\n#>  $ szelkot  : num  4 4 5 5 3 3 3 5 3 5 ...\n#>  $ elegedett: num  1 3 4 1 2 2 4 2 1 1 ...\n#>  $ rendszer : num  2 1 2 4 4 3 2 3 4 2 ...\npsych::headTail(vezetes)\n#>      SUE szelkot elegedett rendszer\n#> 1      1       4         1        2\n#> 2      1       4         3        1\n#> 3      1       5         4        2\n#> 4      1       5         1        4\n#> ... <NA>     ...       ...      ...\n#> 27     3       1         1        5\n#> 28     3       5         1        4\n#> 29     3       5         1        5\n#> 30     3       5         3        4\n```\n:::\n\n\nMivel a MANOVA a három stratégiai üzleti egységben (SÜE) a kérdőívek pontszámainak (vagyis a függő változók) átlagainak különbségire kérdez rá, így készítsünk dobozdiagramot mindhárom csoportban\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\np1 <- ggplot(vezetes, aes(x = SUE, y = szelkot, fill = SUE)) + geom_boxplot() +\n    theme(legend.position = \"top\")\np2 <- ggplot(vezetes, aes(x = SUE, y = elegedett, fill = SUE)) + geom_boxplot() +\n    theme(legend.position = \"top\")\np3 <- ggplot(vezetes, aes(x = SUE, y = rendszer, fill = SUE)) + geom_boxplot() +\n    theme(legend.position = \"top\")\ngridExtra::grid.arrange(p1, p2, p3, nrow = 1)\n```\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-3-1.png){width=576}\n:::\n:::\n\n\nÚgy tűnik, hogy a mindhárom csoport eléggé különbözik egymástól.\n\nVégezzük el az egyszempontos többváltozós variancia elemzést. A `manova()` függvény a `formula=` argumentumában a kettő vagy több numerikus függő változót és legalább egy független változót vár. A függő változókat most a `cbind()` függvénnyel fűztük egymás mellé, a független változónk pedig a 3 szintű kategorikus `SUE`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nman_1 <- manova(formula = cbind(szelkot, elegedett, rendszer) ~ SUE, data = vezetes)\nsummary(man_1)\n#>           Df  Pillai approx F num Df den Df    Pr(>F)    \n#> SUE        2 0.90947   7.2278      6     52 1.211e-05 ***\n#> Residuals 27                                             \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nAlapértelmezés szerint a MANOVA az R-ben a Pillai-féle tesztstatisztikáit használja. A p-érték gyakorlatilag nulla, ami azt jelenti, hogy nyugodtan elvethetjük a nullhipotézist: legalább egy csoportátlagvektor eltér a többitől.\n\nHasználhat más teszteket is, mint például a Wilk-lambda, a Roy-féle vagy a Hotelling-Lawley statisztikákat, de a Pillai-féle a legrobusztosabb.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(man_1, test = \"Wilks\")\n#>           Df  Wilks approx F num Df den Df    Pr(>F)    \n#> SUE        2 0.1894   10.815      6     50 1.102e-07 ***\n#> Residuals 27                                            \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary(man_1, test = \"Hotelling-Lawley\")\n#>           Df Hotelling-Lawley approx F num Df den Df    Pr(>F...\n#> SUE        2           3.7577   15.031      6     48 1.375e-0...\n#> Residuals 27                                                 ...\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nsummary(man_1, test = \"Roy\")\n#>           Df    Roy approx F num Df den Df    Pr(>F)    \n#> SUE        2 3.6133   31.315      3     26 8.724e-09 ***\n#> Residuals 27                                            \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA hatásnagyság kiszámítására MANOVA esetében a parciális Eta négyzet $(\\eta_p^2)$ mutatót használhatjuk. Azt méri, hogy a független változó milyen hatással van a függő változókra. Ha az érték 0,14 vagy nagyobb, akkor azt mondhatjuk, hogy a hatás mérete nagy. Ez most 0,45, ami azt jelenti, hogy a hatás mérete nagy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\neffectsize::eta_squared(man_1, partial = T)\n#> # Effect Size for ANOVA (Type I)\n#> \n#> Parameter | Eta2 (partial) |       95% CI\n#> -----------------------------------------\n#> SUE       |           0.45 | [0.24, 1.00]\n#> \n#> - One-sided CIs: upper bound fixed at [1.00].\neffectsize::interpret_eta_squared(0.45, partial = T)\n#> [1] \"large\"\n#> (Rules: field2013)\n```\n:::\n\n\nMivel a MANOVA szignifikáns lett, további kérdés, hogy melyik csoport átlagvektora különbözik a többitől? Post-hoc tesztet kell végeznünk, amely esetünkben a lineáris diszkriminancia elemzés és az egyváltozós ANOVA lesz.\n\n## Post-hoc teszt: LDA\n\nA lineáris diszkriminancia elemzés (LDA) célja, hogy változók olyan lineáris kombinációját találja meg, amely a legjobban elválaszt két vagy több csoportot. Ezáltal képesek leszünk egy olyan pontdiagramot megjeleníteni, amely az X és Y tengely két lineáris diszkriminánst jeleníti meg, a pontokat pedig a független változónak (`SUE`) megfelelően fogjuk színezni.\n\nA lineáris diszkriminancia elemzést R-ben a `{MASS}` csomag `lda()` függvényével végzünk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlda_1 <- lda(SUE ~ szelkot + elegedett + rendszer, data = vezetes)\nlda_1\n#> Call:\n#> lda(SUE ~ szelkot + elegedett + rendszer, data = vezetes)\n#> \n#> Prior probabilities of groups:\n#>         1         2         3 \n#> 0.3333333 0.3333333 0.3333333 \n#> \n#> Group means:\n#>   szelkot elegedett rendszer\n#> 1     4.0       2.1      2.7\n#> 2     4.7       3.4      1.5\n#> 3     4.1       1.6      4.7\n#> \n#> Coefficients of linear discriminants:\n#>                   LD1       LD2\n#> szelkot   -0.07056752 0.4959142\n#> elegedett  0.10193972 0.8596451\n#> rendszer  -1.32360357 0.5392379\n#> \n#> Proportion of trace:\n#>    LD1    LD2 \n#> 0.9616 0.0384\n# klaR::greedy.wilks(vasarlas~ertek+attitud+fizetes+kor,data=bio,\n# niveau = 0.15)\n```\n:::\n\n\nA fenti együtthatókból megtudhatjuk hogyan használják fel a függő változókat az LDA döntési szabályának kialakítására. Az LD1 a következőképpen számítható ki: \n\nA `vezetes` adatmátrix numerikus változóira magunk is kiszámolhatjuk az LD1 és LDA2 értékét a `predict()` függvénnyel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlda_1_pred <- predict(lda_1, method = \"plug-in\")\npsych::headTail(lda_1_pred$x)\n#>       LD1   LD2\n#> 1    1.16 -1.83\n#> 2    2.69 -0.65\n#> 3    1.39  1.25\n#> 4   -1.56 -0.25\n#> ...   ...   ...\n#> 27   -2.6  -1.7\n#> 28  -1.56 -0.25\n#> 29  -2.88  0.29\n#> 30  -1.35  1.47\n```\n:::\n\n\nA post-hoc teszt utolsó lépése a fenti a pontdiagram megjelenítése. Ideális esetben egy vagy több csoport kiemelkedik:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nd <- data.frame(lda_1_pred$x, SUE = vezetes$SUE)\npsych::headTail(d)\n#>       LD1   LD2  SUE\n#> 1    1.16 -1.83    1\n#> 2    2.69 -0.65    1\n#> 3    1.39  1.25    1\n#> 4   -1.56 -0.25    1\n#> ...   ...   ... <NA>\n#> 27   -2.6  -1.7    3\n#> 28  -1.56 -0.25    3\n#> 29  -2.88  0.29    3\n#> 30  -1.35  1.47    3\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(d, aes(x = LD1, y = LD2, colour = SUE)) + geom_point(size = 4)\n```\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-10-1.png){width=576}\n:::\n:::\n\n\n\nA képen látható, hogy a harmadik SÜE csoport eltér mindkét másik csoporttól, míg a az első két csoport eltérése egymástól nem mondható markánsnak. Könnyen elképzelhető, hogy a SÜE harmadik csoportja volt a legnagyobb hatással a nullhipotézis elutasítására.\n\n## Post-hoc test: egyváltozós vizsgálatok\n\nA statisztikailag szignifikáns egyszempontos MANOVA után az egyváltozós egyszempontos ANOVA-val is vizsgálódhatunk, amely minden függő változót külön-külön vizsgál. A cél az, hogy azonosítsuk azokat a konkrét függő változókat, amelyek hozzájárultak a jelentős globális hatáshoz. A klasszikus ANOVA mellett a Welch-féle változat és a Kruskal--Wallis-próba is használható, a feltételek egyre nagyobb csorbulása esetén. Most a nemparaméteres Kruskal--Wallis-próbát használjuk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(szelkot ~ SUE, data = vezetes)$p.value\n#> [1] 0.2499069\nkruskal.test(elegedett ~ SUE, data = vezetes)$p.value\n#> [1] 0.003003241\nkruskal.test(rendszer ~ SUE, data = vezetes)$p.value\n#> [1] 1.690362e-05\n```\n:::\n\n\n\nLátjuk, hogy az `elegedett` és a `rendszer` függő változókban nem egyeznek a várható értékek a SÜE egyes csoportjaiban. Megjegyezzük, hogy mivel 3 függő változónk van, a Bonferroni-féle többszörös tesztelési korrekciót alkalmaznunk kell, vagyis a statisztikai szignifikancia szintet csökkenteni kell. Ez úgy történik, hogy a klasszikus alfa szintet (0,05) elosztjuk a tesztek (vagy függő változók, itt 3) számával. Ez p < 0,017-es szignifikancia elfogadási kritériumhoz vezet. A fenti próbák szignifikáns voltán ez most nem változtat.\n\nA statisztikailag szignifikáns egyváltozós ANOVA-t (esetünkben Kruskal--Wallis-próbát) többszörös páronkénti összehasonlítás követi annak meghatározására, hogy mely csoportok különböznek egymástól. Most a Kruskal--Wallis-próba szokásos utóvizsgálatát a Dunn-próbát fogjuk használni.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DescTools)\nDunnTest(formula = szelkot ~ SUE, data = vezetes, method = \"holm\")\n#> \n#>  Dunn's test of multiple comparisons using rank sums : holm  \n#> \n#>     mean.rank.diff   pval    \n#> 2-1            5.6 0.3179    \n#> 3-1            4.0 0.4964    \n#> 3-2           -1.6 0.6442    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nDunnTest(formula = elegedett ~ SUE, data = vezetes, method = \"holm\")\n#> \n#>  Dunn's test of multiple comparisons using rank sums : holm  \n#> \n#>     mean.rank.diff   pval    \n#> 2-1           8.75 0.0410 *  \n#> 3-1          -3.80 0.3143    \n#> 3-2         -12.55 0.0027 ** \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nDunnTest(formula = rendszer ~ SUE, data = vezetes, method = \"holm\")\n#> \n#>  Dunn's test of multiple comparisons using rank sums : holm  \n#> \n#>     mean.rank.diff    pval    \n#> 2-1          -6.95  0.0694 .  \n#> 3-1          10.85  0.0092 ** \n#> 3-2          17.80 9.9e-06 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\nA fenti utóvizsgálatok világossá teszik, hogy a harmadik SÜE csoport a `rendszer` változó esetén mindkét másik csoporttól, az `elegedett` változó esetén pedig a második csoporttól szignifikánsan eltér. Legjelentősebb mértékben tehűt a harmadik csoport különül el a másik két csoporttól, tehát ez okozza a MANOVA nullhipotézisének elvetését.\n\n\n## Elemzés jamovi-ban\n\n\nA fenti elemzés jamovi-ban is elvégezhető az `ANOVA / MANCOVA` menüpontok kiválasztásával.\n\n![MANOVA jamovi-ban](images/manova_kep_01.jpg)\n\n\n## Alkalmazási feltételek vizsgálata\n\nA MANOVA statisztikai próbának számos szigorú alkalmazási feltétele van. Néhány az ANOVA-ból jön, például a megfigyelések függetlensége vagy a variancia homogenitása, azonban vannak újdonságok is.\n\n\n* **Megfelelő mintanagyság.** Ökölszabály: a mintaelemszám mindegyik független változó csoportban nagyobb az függő változók számánál.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarytools::freq(vezetes$SUE, cumul = FALSE)\n#> Frequencies  \n#> vezetes$SUE  \n#> Type: Factor  \n#> \n#>               Freq   % Valid   % Total\n#> ----------- ------ --------- ---------\n#>           1     10     33.33     33.33\n#>           2     10     33.33     33.33\n#>           3     10     33.33     33.33\n#>        <NA>      0                0.00\n#>       Total     30    100.00    100.00\n```\n:::\n\n\n\nLátható, hogy a függő változók számát (3) minden csoport elemszáma (10) meghaladja.\n\n* **A megfigyelések függetlensége.** Minden személynek csak egy csoportba kell tartoznia. Az egyes csoportok megfigyelései között nincs kapcsolat. Az ismételt mérések nem megengedettek. A minta kiválasztásának teljesen véletlenszerűnek kell lennie.\n\n* **Az egyváltozós vagy többváltozós kiugró értékek hiánya.**\n\nAz egydimenziós kiugró értékek dobozdiagramokkal is ellenőrizhetők, ezt korábban elvégeztük, láttuk csak egyetlen részcsoportban van kiugró értékek (a `szelkot` változó változó esetén a SÜE harmadik csoportjában). Használhatjuk a kényelmes `rstatix::identify_outliers()` függvényt is.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nvezetes %>%\n    group_by(SUE) %>%\n    rstatix::identify_outliers(szelkot)\n#> # A tibble: 2 × 6\n#>   SUE   szelkot elegedett rendszer is.outlier is.extreme\n#>   <fct>   <dbl>     <dbl>    <dbl> <lgl>      <lgl>     \n#> 1 3           1         1        5 TRUE       TRUE      \n#> 2 3           1         1        5 TRUE       TRUE\nvezetes %>%\n    group_by(SUE) %>%\n    rstatix::identify_outliers(elegedett)\n#> [1] SUE        szelkot    elegedett  rendszer   is.outlier\n#> [6] is.extreme\n#> <0 rows> (or 0-length row.names)\nvezetes %>%\n    group_by(SUE) %>%\n    rstatix::identify_outliers(rendszer)\n#> [1] SUE        szelkot    elegedett  rendszer   is.outlier\n#> [6] is.extreme\n#> <0 rows> (or 0-length row.names)\n```\n:::\n\n\n\nA többváltozós kiugró értékek olyan adatpontok, amelyek szokatlan értékkombinációt tartalmaznak a kimeneti (vagy függő) változókon. A Mahalanobis távolságot általában a többváltozós kiugró értékek észlelésére használják. A távolság megmondja, milyen messze van egy megfigyelés a felhő középpontjától, figyelembe véve a felhő alakját (kovariancia) is. A `rstatix::mahalanobis_distance()` függvény könnyen használható a Mahalanobis-távolság kiszámítására és a többváltozós kiugró értékek megjelölésére. A Mahalanobis-távolságot csoportonként kell kiszámítani:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvezetes %>%\n    group_by(SUE) %>%\n    rstatix::mahalanobis_distance() %>%\n    filter(is.outlier == TRUE) %>%\n    as.data.frame()\n#> [1] szelkot    elegedett  rendszer   mahal.dist is.outlier\n#> <0 rows> (or 0-length row.names)\n```\n:::\n\n\nLátható, hogy nincs többváltozós kiugró érték az adatbázisban.\n\n* **Többváltozós normalitás.** \n\nA többváltozós normalitás Shapiro-Wilk tesztjének végrehajtása:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrstatix::mshapiro_test(vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")])\n#> # A tibble: 1 × 2\n#>   statistic   p.value\n#>       <dbl>     <dbl>\n#> 1     0.772 0.0000214\n```\n:::\n\n\nLátható, hogy ez az alkalmazási feltétel nem teljesül.\n\nAz egyváltozós normalitásokat is érdemes lehet tesztelni:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# egyváltozós Shapiro–Wilk próba több csoportra\nlibrary(onewaytests)\nnor.test(formula = szelkot ~ SUE, data = vezetes, method = \"SW\")\n#> \n#>   Shapiro-Wilk Normality Test (alpha = 0.05) \n#> -------------------------------------------------- \n#>   data : szelkot and SUE \n#> \n#>   Level Statistic      p.value   Normality\n#> 1     1 0.7685823 6.009970e-03      Reject\n#> 2     2 0.5941735 4.713464e-05      Reject\n#> 3     3 0.5876023 3.936679e-05      Reject\n#> --------------------------------------------------\nnor.test(formula = elegedett ~ SUE, data = vezetes, method = \"SW\")\n#> \n#>   Shapiro-Wilk Normality Test (alpha = 0.05) \n#> -------------------------------------------------- \n#>   data : elegedett and SUE \n#> \n#>   Level Statistic      p.value   Normality\n#> 1     1 0.8236140 2.802300e-02      Reject\n#> 2     2 0.7172415 1.425861e-03      Reject\n#> 3     3 0.5941735 4.713464e-05      Reject\n#> --------------------------------------------------\nnor.test(formula = rendszer ~ SUE, data = vezetes, method = \"SW\")\n#> \n#>   Shapiro-Wilk Normality Test (alpha = 0.05) \n#> -------------------------------------------------- \n#>   data : rendszer and SUE \n#> \n#>   Level Statistic      p.value   Normality\n#> 1     1 0.8737456 1.105101e-01  Not reject\n#> 2     2 0.6552710 2.539627e-04      Reject\n#> 3     3 0.5941735 4.713464e-05      Reject\n#> --------------------------------------------------\n```\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-17-1.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-17-2.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-17-3.png){width=576}\n:::\n:::\n\n\n* **A multikollinearitás hiánya.** A függő (eredmény) változók nem korrelálhatnak túlságosan egymással. Egyetlen korreláció sem lehet r = 0,90 feletti. \n\nIdeális esetben az eredményváltozók közötti korreláció mérsékelt, nem túl magas. A 0,9 feletti korreláció a multikollinearitást jelzi, ami a MANOVA esetében problematikus. Másrészt, ha a korreláció túl alacsony, fontolóra kell vennie külön egyszempontos ANOVA futtatását minden függő változóra.\n\nSzámítsuk ki a páronkénti Pearson-korrelációs együtthatókat a függő változók között. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")])\n#>              szelkot  elegedett   rendszer\n#> szelkot    1.0000000  0.1954881 -0.2528624\n#> elegedett  0.1954881  1.0000000 -0.6129079\n#> rendszer  -0.2528624 -0.6129079  1.0000000\n```\n:::\n\n\nLátható, hogy a korrelációs együtthatók nem támogatják a multikollinearitás tényét. \n\n* **Linearitás az összes függő változó között minden csoportban.**\n\nMivel a függő változók közötti páronkénti kapcsolatnak lineárisnak kell lennie minden csoport esetében, ezért érdemes ezt a feltételt vizuálisan ellenőrizni. A `{GGally}` csomag `ggpairs()` függvényét használhatjuk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\nres <- vezetes %>%\n    select(SUE, szelkot, elegedett, rendszer) %>%\n    group_by(SUE) %>%\n    rstatix::doo(~ggpairs(.) + theme_bw(), result = \"plots\")\nres$plots\n#> [[1]]\n#> \n#> [[2]]\n#> \n#> [[3]]\n```\n\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-19-1.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-19-2.png){width=576}\n:::\n\n::: {.cell-output-display}\n![](sec_tobbvaltozos_variancia_files/figure-html/unnamed-chunk-19-3.png){width=576}\n:::\n:::\n\n\nA fenti ábrák megkérdőjelezik a páronkénti lineáris kapcsolatok létezését.\n\n* **A varianciák homogenitása.** A Levene-próba használható a csoportok közötti varianciák egyenlőségének tesztelésére. A Levene-próba nem szignifikáns értékei a varianciák homogenitását támogatják. \n\nAz egyszempontos MANOVA mindegyik függő változó esetében azt feltételezi, hogy a csoportok között egyenlők a varianciák. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDescTools::LeveneTest(szelkot ~ SUE, data = vezetes)\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value Pr(>F)\n#> group  2  0.9755 0.3899\n#>       27\nDescTools::LeveneTest(elegedett ~ SUE, data = vezetes)\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value Pr(>F)\n#> group  2  0.4112  0.667\n#>       27\nDescTools::LeveneTest(rendszer ~ SUE, data = vezetes)\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value   Pr(>F)   \n#> group  2     5.6 0.009238 **\n#>       27                    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n\n\nLátható, hogy a szóráshomogenitás a `rendszer` változó kivételével teljesül.\n\n* **Variancia-kovariancia mátrixok homogenitása.** A BoxM-próba használható a csoportok közötti kovariancia egyenlőségének ellenőrzésére. Ez egyenértékű a variancia többváltozós homogenitásával. Ez a teszt rendkívül érzékenynek tekinthető. Ezért ennek a tesztnek a szignifikanciáját alfa = 0,001 értéknél határozzuk meg. A `{biotools}` csomag megvalósított `boxM()` függvényét használhatjuk.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbiotools::boxM(data = vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")], grouping = vezetes$SUE)\n#> \n#> \tBox's M-test for Homogeneity of Covariance Matrices\n#> \n#> data:  vezetes[c(\"szelkot\", \"elegedett\", \"rendszer\")]\n#> Chi-Sq (approx.) = 19.607, df = 12, p-value = 0.0749\n```\n:::\n\n\nA teszt statisztikailag nem szignifikáns (azaz p > 0,001), tehát az adatok nem sértették meg a variancia-kovariancia mátrixok homogenitásának feltételezését.\n\nKiegyensúlyozott a csoportelemszámok esetén nem probléma a variancia-kovariancia mátrixok homogenitásának megsértése miatt, de kiegyensúlyozatlan kialakításnál már problémás lehet. \n\n",
    "supporting": [
      "sec_tobbvaltozos_variancia_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}